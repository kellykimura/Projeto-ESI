/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package ghibli.interfaces;

import ghibli.modelo.Cliente;
import ghibli.modelo.Filme;
import ghibli.modelo.Item;

import javax.swing.*;
import java.awt.event.*;
import java.util.ArrayList;

/**
 * Janela que mostra o catálogo de filmes disponíveis.
 * Permite que o cliente visualize e adicione filmes ao carrinho.
 * Também permite acessar o carrinho para finalizar comprar ou locações.
 * 
 * @author Gabrielly
 */
public class CatalogoFrame extends javax.swing.JFrame {

    /**
     * Lista gráfica com os títulos dos filmes disponíveis.
     */
    private JList<String> listaFilmes;
    
    /**
     * Botão para adicionar o filme selecionado ao carrinho
     */
    private JButton adicionarCarrinhoBtn;
    
    /**
     * Botão para visualizar o carrinho atual.
     */
    private JButton verCarrinhoBtn;
    
    /**
     * Lista de filmes disponíveis no catálogo.
     */
    private ArrayList<Filme> filmesDisponiveis = new ArrayList<>();
    
    /**
     * Lista dos itens adicionados ao carrinho pelo cliente.
     */
    private ArrayList<Item> carrinho = new ArrayList<>();
    
    /**
     * Cliente que está navegando pelo catálogo.
     */
    private Cliente cliente;
    
    
    /**
     * Construtor que cria a interface do catálofo para um cliente específico.
     * 
     * @param cliente Cliente que está utilizando o catálogo.
     */
    public CatalogoFrame(Cliente cliente) {
        
        this.cliente = cliente;
        
        this.filmesDisponiveis = ghibli.persistencia.PersistenciaFilme.carregar();
        
        setTitle("Catálogo de Filmes - Ghibli Store");
        setSize(400, 400);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setLayout(null);

        // exemplo
        //filmesDisponiveis.add(new Filme("A Viagem de Chihiro", "2001", "Fantasia", "Hayao Miyazaki", "Garota entra em mundo mágico."));
        //filmesDisponiveis.add(new Filme("Meu Amigo Totoro", "1988", "Animação", "Hayao Miyazaki", "Duas irmãs conhecem espírito da floresta."));

        String[] titulos = filmesDisponiveis.stream().map(Filme::getTitulo).toArray(String[]::new);
        listaFilmes = new JList<>(titulos);
        JScrollPane scrollPane = new JScrollPane(listaFilmes);
        scrollPane.setBounds(30, 30, 320, 200);
        add(scrollPane);

        adicionarCarrinhoBtn = new JButton("Adicionar ao Carrinho");
        adicionarCarrinhoBtn.setBounds(30, 250, 160, 30);
        add(adicionarCarrinhoBtn);

        verCarrinhoBtn = new JButton("Ver Carrinho");
        verCarrinhoBtn.setBounds(200, 250, 150, 30);
        add(verCarrinhoBtn);

        // Evento para adicionar o filme selecionado ao carrinho
        adicionarCarrinhoBtn.addActionListener(e -> {
            int idx = listaFilmes.getSelectedIndex();
            if (idx >= 0) {
                Filme filmeSelecionado = filmesDisponiveis.get(idx);
                Item novoItem = new Item("SER" + (carrinho.size() + 1), "08/06/2025", filmeSelecionado);
                //novoItem.adicionarCarrinho();
                carrinho.add(novoItem);
            } else {
                JOptionPane.showMessageDialog(this, "Selecione um filme.");
            }
        });

        // Evento para visualizar o carrinho
        verCarrinhoBtn.addActionListener(e -> {
            new CarrinhoFrame(cliente, carrinho).setVisible(true);
            dispose();
        });
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    /**
     * Método principal para testes da interface do catálogo.
     *
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(CatalogoFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(CatalogoFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(CatalogoFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(CatalogoFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                Cliente cliente = new Cliente("Antônia", "antonia@gmail.com", "12345678901", "a", "senha123");
                new CatalogoFrame(cliente).setVisible(true);

            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    // End of variables declaration//GEN-END:variables
}
